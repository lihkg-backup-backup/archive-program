{"tid":314856,"cid":26,"subCid":0,"title":"virtual machine問題","createTime":"2017-07-09T14:46:39.000Z","updateTime":"2017-07-10T16:59:39.000Z","uid":122576,"like":0,"dislike":0,"uniUserReply":0,"replies":[{"pid":"6d35c98f58e93d9ff3e584e2e34d944c3b57b8b8","tid":314856,"uid":122576,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-09T14:46:39.000Z","msg":"是咁的，小弟戇鳩，用少少時間寫咗個virtual machine，但卡死係某一part<img src=\"/assets/faces/normal/cry.gif\" class=\"hkgmoji\" /> <img src=\"/assets/faces/normal/cry.gif\" class=\"hkgmoji\" /> <br />\n<br />\n小弟寫嘅係stack machine，所以讀落去有啲麻煩<br />\n<br />\n但係我唔知點解決call嘅問題<img src=\"/assets/faces/normal/cry.gif\" class=\"hkgmoji\" /> 點樣先可以實作call stack<br />\n<br />\n呢家無限loop間唔知點搞<br />\n<br />\n<a href=\"https://pastebin.com/LVhW004q\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fpastebin.com%2FLVhW004q&d=fKT5z0tl%2FxQhe5irkuChEGxr1Wzy5cvmMlqj7aCMUDs%3D&h=663a9d7f\" data-auto-link target=\"_blank\">https://pastebin.com/LVhW004q</a>"},{"pid":"9fb0f040ba6ecb2043d3256618d009ca7c152d36","tid":314856,"uid":28563,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-09T15:17:01.000Z","msg":"行唔行到linux？"},{"pid":"7ce0e77197a24c8b51ffcb13e9ea41c17ff3e8e8","tid":314856,"uid":122576,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-09T15:27:09.000Z","msg":"小弟好似得咗<br />\n<br />\n<a href=\"https://pastebin.com/03Di6t5f\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fpastebin.com%2F03Di6t5f&d=fKT5z0tl%2FxQhe5irkuChEGxr1Wzy5cvmMlqj7aCMUDs%3D&h=b7771635\" data-auto-link target=\"_blank\">https://pastebin.com/03Di6t5f</a><br />\n<br />\npass到program exit<br />\n<br />\n但唔知咁樣得唔得<br />\n<br />\n尤其是call果段真係好ghetto<img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" /> <br />\n<br />\n因為按照 <a href=\"http://www.c-jump.com/CIS77/ASM/Procedures/P77_0010_call_ret.htm\" data-sr-url=\"https://r.lihkg.com/link?u=http%3A%2F%2Fwww.c-jump.com%2FCIS77%2FASM%2FProcedures%2FP77_0010_call_ret.htm&d=fKT5z0tl%2FxQhe5irkuChEGxr1Wzy5cvmMlqj7aCMUDs%3D&h=0c57ca2b\" data-auto-link target=\"_blank\">http://www.c-jump.com/CIS77/ASM/Procedures/P77_0010_call_ret.htm</a> 我做嘅procedure應該係錯嘅<img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" /> <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" /> <br />\n<br />\n諗下應該點fix<img src=\"/assets/faces/normal/wonder.gif\" class=\"hkgmoji\" />"},{"pid":"63e746fab0cf44196a186be7ff65f16e7f9ec6cf","tid":314856,"uid":122576,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-09T15:27:43.000Z","msg":"<blockquote>行唔行到linux？</blockquote><br />\n點會行唔到<br />\n<br />\nc++ portable架"},{"pid":"61409dfbbda5822caaebee09d15d32cce4ab31a9","tid":314856,"uid":105553,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-09T22:54:24.000Z","msg":"You need to push the *return address*, not the call site.  I would do something like:<br />\n<br />\n/* call */<br />\ncallee = ip + read()  /* assuming relative address encoding */<br />\ncallstack.push(ip)<br />\nip = callee"},{"pid":"10a543e78004956ec50fd1b85194ea84ed210a4b","tid":314856,"uid":122576,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T03:08:04.000Z","msg":"<blockquote>You need to push the *return address*, not the call site.  I would do something like:<br />\n<br />\n/* call */<br />\ncallee = ip + read()  /* assuming relative address encoding */<br />\ncallstack.push(ip)<br />\nip = callee</blockquote><br />\n<br />\n聽完巴打你講完 我跟手做咗個fix<br />\n<br />\n唔知啱唔啱架<br />\n<br />\n<a href=\"https://pastebin.com/G57gmrk3\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fpastebin.com%2FG57gmrk3&d=fKT5z0tl%2FxQhe5irkuChEGxr1Wzy5cvmMlqj7aCMUDs%3D&h=67c3d890\" data-auto-link target=\"_blank\">https://pastebin.com/G57gmrk3</a>"},{"pid":"afb2b901b6c1e2abafdd1c82de8bd13b745bea5b","tid":314856,"uid":105553,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T04:04:52.000Z","msg":"<blockquote><blockquote>行唔行到linux？</blockquote><br />\n點會行唔到<br />\n<br />\nc++ portable架</blockquote><br />\n<br />\nC++ may be portable but your code is not portable. <img src=\"/assets/faces/normal/hehe.gif\" class=\"hkgmoji\" /> <br />\n<a href=\"https://en.wikipedia.org/wiki/Endianness\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FEndianness&d=fKT5z0tl%2FxQhe5irkuChEGxr1Wzy5cvmMlqj7aCMUDs%3D&h=4915c3c5\" target=\"_blank\">https://en.wikipedia.org/wiki/Endianness</a>"},{"pid":"ddfbc8e90f508cf783d6d2b06da23b5946dcbe4f","tid":314856,"uid":38316,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T04:10:53.000Z","msg":"寫VM你係無可能做倒portable<br />\n唔同OS machine code既implementation都唔同"},{"pid":"bc3bf8319ea3c40bb09ee7740009c390ab042ded","tid":314856,"uid":105553,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T04:14:10.000Z","msg":"<blockquote>寫VM你係無可能做倒portable<br />\n唔同OS machine code既implementation都唔同</blockquote><br />\n<br />\nIf you do not consider efficiency, you can be quite portable."},{"pid":"e36f46b1b5471dcc1facd8dbc03b44adb3499604","tid":314856,"uid":38316,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T04:26:50.000Z","msg":"<blockquote><blockquote>寫VM你係無可能做倒portable<br />\n唔同OS machine code既implementation都唔同</blockquote><br />\n<br />\nIf you do not consider efficiency, you can be quite portable.</blockquote><br />\n我唔係做開底層<br />\n咁放棄咗efficiency嚟搞portable，做出嚟個嘢會唔會&quot;practical&quot;?"},{"pid":"11632aeec748aa8165d97b4cbcd7a31d45e564e7","tid":314856,"uid":122576,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T04:32:49.000Z","msg":"除咗power我真係諗唔到有咩cpu係big endian<br />\n<br />\n就算係arm都係biendian<br />\n<br />\nendianess就算啦 都係行x86姐"},{"pid":"a68aee75f5c2adb45968b6fe18d4ecd3073aff25","tid":314856,"uid":105553,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T04:38:27.000Z","msg":"<blockquote>除咗power我真係諗唔到有咩cpu係big endian<br />\n<br />\n就算係arm都係biendian<br />\n<br />\nendianess就算啦 都係行x86姐</blockquote><br />\n<br />\nVAX.  I used VAX once :-)<br />\n<br />\nPOWER is bi-endian :-)  You can buy a little-endian POWER system running Linux from IBM.<br />\n<br />\n<a href=\"https://openpowerfoundation.org/blogs/introducing-the-little-endian-openpower-software-development-environment-and-its-application-programming-interfaces/\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fopenpowerfoundation.org%2Fblogs%2Fintroducing-the-little-endian-openpower-software-development-environment-and-its-application-programming-interfaces%2F&d=fKT5z0tl%2FxQhe5irkuChEGxr1Wzy5cvmMlqj7aCMUDs%3D&h=af23be2c\" target=\"_blank\">https://openpowerfoundation.org/blogs/introducing-the-little-endian-openpower-software-development-environment-and-its-application-programming-interfaces/</a><br />\n<br />\nCPU of routers are usually running in big-endian mode."},{"pid":"dd676890a1f8c9412adb89847217f57a87198477","tid":314856,"uid":105553,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T04:40:55.000Z","msg":"<blockquote><blockquote><span style=\"color: red;\">除咗power我真係諗唔到有咩cpu係big endian</span><br />\n<br />\n就算係arm都係biendian<br />\n<br />\nendianess就算啦 都係行x86姐</blockquote><br />\n<br />\nVAX.  I used VAX once :-)<br />\n<br />\nPOWER is bi-endian :-)  You can buy a little-endian POWER system running Linux from IBM.<br />\n<br />\n<a href=\"https://openpowerfoundation.org/blogs/introducing-the-little-endian-openpower-software-development-environment-and-its-application-programming-interfaces/\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fopenpowerfoundation.org%2Fblogs%2Fintroducing-the-little-endian-openpower-software-development-environment-and-its-application-programming-interfaces%2F&d=fKT5z0tl%2FxQhe5irkuChEGxr1Wzy5cvmMlqj7aCMUDs%3D&h=af23be2c\" target=\"_blank\">https://openpowerfoundation.org/blogs/introducing-the-little-endian-openpower-software-development-environment-and-its-application-programming-interfaces/</a><br />\n<br />\nCPU of routers are usually running in big-endian mode.</blockquote><br />\n<br />\nAlso the Motorola MC680x0 series, Sun SPARC.  I have programmed both in assembly :-)<br />\n<br />\nMIPS is also bi-endian.  MIPS are popular in routers, those are usually in big-endian mode."},{"pid":"5f4c341e33f77296c41642800214a7063c097107","tid":314856,"uid":105553,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T05:01:49.000Z","msg":"<blockquote><blockquote><blockquote>寫VM你係無可能做倒portable<br />\n唔同OS machine code既implementation都唔同</blockquote><br />\n<br />\nIf you do not consider efficiency, you can be quite portable.</blockquote><br />\n我唔係做開底層<br />\n咁放棄咗efficiency嚟搞portable，做出嚟個嘢會唔會&quot;practical&quot;?</blockquote><br />\n<br />\nFor some applications using a simple interpreter to implement a VM is sufficient."},{"pid":"f3b43b1eca932aee76d1cd6d62b6f37caed50dcd","tid":314856,"uid":122576,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T13:41:17.000Z","msg":"<blockquote><blockquote><blockquote><blockquote>寫VM你係無可能做倒portable<br />\n唔同OS machine code既implementation都唔同</blockquote><br />\n<br />\nIf you do not consider efficiency, you can be quite portable.</blockquote><br />\n我唔係做開底層<br />\n咁放棄咗efficiency嚟搞portable，做出嚟個嘢會唔會&quot;practical&quot;?</blockquote><br />\n<br />\nFor some applications using a simple interpreter to implement a VM is sufficient.</blockquote><br />\n<br />\ninterpreter出error嘅時候應該點解決?<br />\n<br />\n一直諗緊佢dynamic code generation嘅問題<br />\n<br />\n如果eval過程中出錯 javascript點處理?"},{"pid":"c41792e1504910410465870694f8a82eca61856d","tid":314856,"uid":105553,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-07-10T16:59:39.000Z","msg":"乜error？virtual machine嘅error定係個interpreter嘅error？<br />\n<br />\n如果係前者就睇你vm點設計。你可以停咗個vm又或者響vm program裡面處理。舉例，你division by zero，你可以響vm裡面raise個exception，save起ip，set ip做exception handler嘅開始。<br />\n<br />\n如果係後者就係一般program error係處理問題。"}]}