{"tid":1596369,"cid":28,"subCid":0,"title":"回覆太多括號() 會出唔到post","createTime":"2019-09-26T13:11:41.000Z","updateTime":"2019-09-26T14:05:00.000Z","uid":59363,"like":2,"dislike":0,"uniUserReply":4,"replies":[{"pid":"2767e942de6de5e3af73fb1cb05bb5a43e0c3c3a","tid":1596369,"uid":59363,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2019-09-26T13:11:41.000Z","msg":"<a href=\"https://lihkg.com/thread/1583588/page/17\" target=\"_blank\">https://lihkg.com/thread/1583588/page/17</a><br />\n<br />\n我係呢個post同人地講緊excel<br />\n但係次次個回覆一有太多(( )) 之類就會出唔到post<br />\n佢彈個「遇到未知錯誤出黎」<br />\n我知係括號既問題係因為我將() replace哂做[ ] 就出到post<br />\n<br />\n請解決<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" />"},{"pid":"702cac09ac919f1140733c801f2c22cb2cb36404","tid":1596369,"uid":169262,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2019-09-26T13:21:10.000Z","msg":"五大訴求，缺一不可<br />\n<img src=\"https://na.cx/i/oq9Tz9f.jpg\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fna.cx%2Fi%2Foq9Tz9f.jpg&h=dc0f42d1&s={SIZE}\" />"},{"pid":"7998c836efe9b1ade605dd60a3a10c3b5e0056a8","tid":1596369,"uid":250511,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2019-09-26T13:29:05.000Z","msg":"(((((())))))))"},{"pid":"97d20628b8b8a291e74cf4ec020ac9b2a6048fed","tid":1596369,"uid":250511,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-09-26T13:29:57.000Z","msg":"1(2)2(1)22(1)2(1)1(2)1()12()1(1)2(1)1(1)1(11)1(1)1(1)1(1)(1)1"},{"pid":"06572df548f0043058b78fbd814ae8a3ec5058c7","tid":1596369,"uid":59363,"like":0,"dislike":0,"score":0,"quote":{"pid":"97d20628b8b8a291e74cf4ec020ac9b2a6048fed","tid":1596369,"uid":250511,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-09-26T13:29:57.000Z","msg":"1(2)2(1)22(1)2(1)1(2)1()12()1(1)2(1)1(1)1(11)1(1)1(1)1(1)(1)1"},"citedBy":1,"replyTime":"2019-09-26T13:47:08.000Z","msg":"唔係咁樣<br />\n我一大段formula貼出黎<br />\n再夾d中文落去就會error出唔到<br />\n換哂做[ ] 先得<br />\n你唔信可以試下去我果個post copy我段野,將[] 換番哂做()就明"},{"pid":"e2859578ed5fa59af321e38d1787501efdb61b51","tid":1596369,"uid":250511,"like":0,"dislike":0,"score":0,"quote":{"pid":"06572df548f0043058b78fbd814ae8a3ec5058c7","tid":1596369,"uid":59363,"like":0,"dislike":0,"score":0,"quote":{"pid":"97d20628b8b8a291e74cf4ec020ac9b2a6048fed","tid":1596369,"uid":250511,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-09-26T13:29:57.000Z","msg":"1(2)2(1)22(1)2(1)1(2)1()12()1(1)2(1)1(1)1(11)1(1)1(1)1(1)(1)1"},"citedBy":1,"replyTime":"2019-09-26T13:47:08.000Z","msg":"唔係咁樣<br />\n我一大段formula貼出黎<br />\n再夾d中文落去就會error出唔到<br />\n換哂做[ ] 先得<br />\n你唔信可以試下去我果個post copy我段野,將[] 換番哂做()就明"},"citedBy":2,"replyTime":"2019-09-26T13:49:19.000Z","msg":"解題順便推post先<br />\n呢條formula其實分左兩大部份<br />\n第一部份,好普通既拆array<br />\nRIGHT(LEFT(&quot;,,,&quot;&amp;A1,3-1+SMALL(IF(MID(A1,ROW($1:$1000),1)=&quot;/&quot;,ROW($1:$1000)),ROW($1:$100))),5)5d8cb887f2f6167683345 SMALL({Array},ROW($1:$100))<br />\n之後先用SMALL抽番頭100個數字出黎<br />\n因為上一步個array冇100個數字咁多,大部份都係FALSE<br />\n多左既部份會出ERROR<br />\n<br />\nRIGHT(LEFT(&quot;,,,&quot;&amp;A1,3-1+{Array}),5)<br />\n將每組字拆做5個char既string<br />\n因為要抽&quot;/&quot;前面5個字出黎<br />\n所以冇用mid,而用左left+right既方法<br />\n&quot;,,,&quot;&amp;目的係確保第一個match case前面有足夠字數,如果唔係會炒<br />\n例如01/03<br />\n&quot;/&quot; 既position係2<br />\n咁就整唔到5個char出黎<br />\n所以補左d垃圾係條string前面<br />\n待續"},{"pid":"748a3cd87bf2b54bf6f086b293ad62e4d7047d57","tid":1596369,"uid":225846,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2019-09-26T13:52:28.000Z","msg":"（（（（（（）））（（（（（）（（（（（（（（（（）））））））））））"},{"pid":"e87ebbefaade24a489b390823eb651d6e82ddc07","tid":1596369,"uid":59363,"like":0,"dislike":0,"score":0,"quote":{"pid":"e2859578ed5fa59af321e38d1787501efdb61b51","tid":1596369,"uid":250511,"like":0,"dislike":0,"score":0,"quote":{"pid":"06572df548f0043058b78fbd814ae8a3ec5058c7","tid":1596369,"uid":59363,"like":0,"dislike":0,"score":0,"quote":{"pid":"97d20628b8b8a291e74cf4ec020ac9b2a6048fed","tid":1596369,"uid":250511,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-09-26T13:29:57.000Z","msg":"1(2)2(1)22(1)2(1)1(2)1()12()1(1)2(1)1(1)1(11)1(1)1(1)1(1)(1)1"},"citedBy":1,"replyTime":"2019-09-26T13:47:08.000Z","msg":"唔係咁樣<br />\n我一大段formula貼出黎<br />\n再夾d中文落去就會error出唔到<br />\n換哂做[ ] 先得<br />\n你唔信可以試下去我果個post copy我段野,將[] 換番哂做()就明"},"citedBy":2,"replyTime":"2019-09-26T13:49:19.000Z","msg":"解題順便推post先<br />\n呢條formula其實分左兩大部份<br />\n第一部份,好普通既拆array<br />\nRIGHT(LEFT(&quot;,,,&quot;&amp;A1,3-1+SMALL(IF(MID(A1,ROW($1:$1000),1)=&quot;/&quot;,ROW($1:$1000)),ROW($1:$100))),5)5d8cb887f2f6167683345 SMALL({Array},ROW($1:$100))<br />\n之後先用SMALL抽番頭100個數字出黎<br />\n因為上一步個array冇100個數字咁多,大部份都係FALSE<br />\n多左既部份會出ERROR<br />\n<br />\nRIGHT(LEFT(&quot;,,,&quot;&amp;A1,3-1+{Array}),5)<br />\n將每組字拆做5個char既string<br />\n因為要抽&quot;/&quot;前面5個字出黎<br />\n所以冇用mid,而用左left+right既方法<br />\n&quot;,,,&quot;&amp;目的係確保第一個match case前面有足夠字數,如果唔係會炒<br />\n例如01/03<br />\n&quot;/&quot; 既position係2<br />\n咁就整唔到5個char出黎<br />\n所以補左d垃圾係條string前面<br />\n待續"},"citedBy":0,"replyTime":"2019-09-26T14:03:33.000Z","msg":"解題順便推post先<br />\n呢條formula其實分左兩大部份<br />\n第一部份,好普通既拆array<br />\nRIGHT(LEFT(&quot;,,,&quot;&amp;A1,3-1+SMALL(IF(MID(A1,ROW($1:$1000),1)=&quot;/&quot;,ROW($1:$1000)),ROW($1:$100))),5)5d8cb887f2f6167683345 SMALL({Array},ROW($1:$100))<br />\n之後先用SMALL抽番頭100個數字出黎<br />\n因為上一步個array冇100個數字咁多,大部份都係FALSE<br />\n多左既部份會出ERROR<br />\n<br />\nRIGHT(LEFT(&quot;,,,&quot;&amp;A1,3-1+{Array}),5)<br />\n將每組字拆做5個char既string<br />\n因為要抽&quot;/&quot;前面5個字出黎<br />\n所以冇用mid,而用左left+right既方法<br />\n&quot;,,,&quot;&amp;目的係確保第一個match case前面有足夠字數,如果唔係會炒<br />\n例如01/03<br />\n&quot;/&quot; 既position係2<br />\n咁就整唔到5個char出黎<br />\n所以補左d垃圾係條string前面<br />\n待續"},{"pid":"c97f64dda2190ac0646e632afd44b0e81a6e4b46","tid":1596369,"uid":59363,"like":0,"dislike":0,"score":0,"quote":{"pid":"e2859578ed5fa59af321e38d1787501efdb61b51","tid":1596369,"uid":250511,"like":0,"dislike":0,"score":0,"quote":{"pid":"06572df548f0043058b78fbd814ae8a3ec5058c7","tid":1596369,"uid":59363,"like":0,"dislike":0,"score":0,"quote":{"pid":"97d20628b8b8a291e74cf4ec020ac9b2a6048fed","tid":1596369,"uid":250511,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-09-26T13:29:57.000Z","msg":"1(2)2(1)22(1)2(1)1(2)1()12()1(1)2(1)1(1)1(11)1(1)1(1)1(1)(1)1"},"citedBy":1,"replyTime":"2019-09-26T13:47:08.000Z","msg":"唔係咁樣<br />\n我一大段formula貼出黎<br />\n再夾d中文落去就會error出唔到<br />\n換哂做[ ] 先得<br />\n你唔信可以試下去我果個post copy我段野,將[] 換番哂做()就明"},"citedBy":2,"replyTime":"2019-09-26T13:49:19.000Z","msg":"解題順便推post先<br />\n呢條formula其實分左兩大部份<br />\n第一部份,好普通既拆array<br />\nRIGHT(LEFT(&quot;,,,&quot;&amp;A1,3-1+SMALL(IF(MID(A1,ROW($1:$1000),1)=&quot;/&quot;,ROW($1:$1000)),ROW($1:$100))),5)5d8cb887f2f6167683345 SMALL({Array},ROW($1:$100))<br />\n之後先用SMALL抽番頭100個數字出黎<br />\n因為上一步個array冇100個數字咁多,大部份都係FALSE<br />\n多左既部份會出ERROR<br />\n<br />\nRIGHT(LEFT(&quot;,,,&quot;&amp;A1,3-1+{Array}),5)<br />\n將每組字拆做5個char既string<br />\n因為要抽&quot;/&quot;前面5個字出黎<br />\n所以冇用mid,而用左left+right既方法<br />\n&quot;,,,&quot;&amp;目的係確保第一個match case前面有足夠字數,如果唔係會炒<br />\n例如01/03<br />\n&quot;/&quot; 既position係2<br />\n咁就整唔到5個char出黎<br />\n所以補左d垃圾係條string前面<br />\n待續"},"citedBy":0,"replyTime":"2019-09-26T14:05:00.000Z","msg":"你試呢段<br />\n<br />\n<br />\n我會將所有括號換哂做[ ] , 唔係成日有錯誤<br />\n包容下<br />\n<br />\n好而家認真講<br />\n前面拆array果part個個都差唔多做法<br />\n應該大家都冇咩興趣睇<br />\n用呢條做例子<br />\n20/10, 21-24/11 , 30/12<br />\n拆完就變<br />\n{&quot;,,,20&quot;;&quot;21-24&quot;;&quot; , 30&quot;;#NUM!;...} 下略96個#NUM!;<br />\n<br />\n如果正常咁做,我起碼要CALL多呢段FORMULA 5,6次<br />\n我個appaoch 想做到既係唔需要不斷重覆咁copy and paste<br />\n前面條array果段formula黎做<br />\n因為咁做真係會整到好亂<br />\n同埋好鳩流<br />\n所以我拆完個array之後,個方向就係直接用果一條array磨個答案出黎<br />\n<br />\n{&quot;,,,20&quot;;&quot;21-24&quot;;&quot; , 30&quot;;#NUM!;...}<br />\n由於呢條式已經有21-24,如果可以令呢度兩個數自己相減就好<br />\n但係我要24變左25先,因為咁樣減出黎條數先岩<br />\n所以我要將21-24變做數字,再將佢+1<br />\n而最簡單就係將&quot;-&quot; SUB走佢<br />\nSUBSTITUTE[{&quot;,,,20&quot;;&quot;21-24&quot;;&quot; , 30&quot;;#NUM!;...} ,&quot;-&quot;}<br />\nreturn {&quot;,,,20&quot;;&quot;2124&quot;;&quot; , 30&quot;;#NUM!}<br />\n<br />\n之後我想將佢+1, 但係唔可以就咁+1, 因為如果佢本身係0103咁樣<br />\n+1變數字會出 104, 而唔係0104<br />\n我想留住佢前面個0,所以我+10001, 咁前面個0就唔會冇左<br />\n<br />\n不過做呢樣野之前,我要解決左#NUM!;先,因為&quot;,,,20&quot; 加任何數都會出#VALUE!, 到時就同#NUM!; 分唔開<br />\n#NUM!; 係多左出黎既VALUE, 我要佢尾4個字係0000<br />\n由於我之後將會+10001<br />\n所以我將佢變做-1, 之後再全個ARRAY + 10001<br />\nIFERROR[{&quot;,,,20&quot;;&quot;2124&quot;;&quot; , 30&quot;;#NUM!},-1]+10001<br />\nreturn {#VALUE!;12125;#VALUE!;10000}<br />\n<br />\n#VALUE!代表既係單日既日子<br />\n佢計出黎要係1<br />\n所以我俾個 10102佢 [ 2 -1 = 1] , 其實你俾幾多都得,減出黎係1就得<br />\nIFERROR[{#VALUE!;12125;#VALUE!;10000},10102]<br />\nreturn {10102;12125;10102;10000}<br />\n<br />\n之後重點就黎...<br />\n所有野都準備好,只要將每個value第4,5個char 同 第 2,3個char相減就計完<br />\n首先我將佢拆左出黎,用mid,兩隻兩隻字咁拆<br />\n呢度要拆一個2d array, 係原有單向打直既array度,每個value再打橫拆多一層出黎 [留意, ; 號既分別]<br />\nMID[{10102;12125;10102;10000},{2,4},2]<br />\nreturn {&quot;01&quot;,&quot;02&quot;;&quot;21&quot;,&quot;25&quot;;&quot;01&quot;,&quot;02&quot;;&quot;00&quot;,&quot;00&quot;}<br />\n<br />\n上面每pair 既數, 前面要變負數, 後面要不變, 所以就x 個{-1,1} 落去<br />\n<br />\n{&quot;01&quot;,&quot;02&quot;;&quot;21&quot;,&quot;25&quot;;&quot;01&quot;,&quot;02&quot;;&quot;00&quot;,&quot;00&quot;}*{-1,1}<br />\nreturn {-1,2;-21,25;-1,2;0,0}<br />\n<br />\n最後再sum埋佢,禮成"}]}