{"tid":149586,"cid":26,"subCid":0,"title":"struts vulnerability S2-045","createTime":"2017-03-09T11:32:39.000Z","updateTime":"2017-03-18T13:35:20.000Z","uid":66242,"like":0,"dislike":0,"uniUserReply":0,"replies":[{"pid":"918d6c071e1dbe33bc0dc590b0f3be4589ba8655","tid":149586,"uid":66242,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-03-09T11:32:39.000Z","msg":"剛剛試咗<br />\n唔需要理佢係咪 valid action / file upload function point <br />\n唔需要理佢係咪 POST / GET / PUT <br />\n唔需要真係有 request body <br />\n只需要 request header 有 multipart/form-data 就足以透過 ognl execute remote command <br />\n網上有 python POC, 我自己用 java implement 都 hack 到自己部機<br />\n真係可以好嚴重<br />\n因為一般 url pattern check 會過到<br />\n需要嚮 request header 落 filter <br />\n我建議 firewall filter content-type header 有 &quot;multipart/form-data&quot; 同埋以下 character 嘅 request:<br />\n<span style=\"color: navy;\">#(){}</span><br />\n比較下正常 file upload 嘅 content-type multipart/form-data 應該係乜，對比番 POC 嘅玩法就知"},{"pid":"0bfeb24150f49e788bf122fd4a05b54a1cd9a3a3","tid":149586,"uid":66242,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-03-09T11:54:58.000Z","msg":"戴定頭盔<br />\n警告你哋唔好隨便撞其他唔係你管理嘅網站<br />\n搵自己嘅 server 任你玩就得<br />\n<br />\nBTW 我個 log 記錄唔到自己試嘅 malicious access remote command executive <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},{"pid":"62c5bce052e72ae498658b99bdec33883e9fc13c","tid":149586,"uid":28563,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-03-09T12:28:40.000Z","msg":"仲有人用java寫web<img src=\"/assets/faces/normal/@.gif\" class=\"hkgmoji\" />"},{"pid":"94e7b3167072a4e111724ec9b7bb1e449d2f8b9b","tid":149586,"uid":24795,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2017-03-18T13:35:20.000Z","msg":"<blockquote>仲有人用java寫web<img src=\"/assets/faces/normal/@.gif\" class=\"hkgmoji\" /></blockquote><br />\nI大仲教緊jsp<img src=\"/assets/faces/fs/smile.gif\" class=\"hkgmoji\" /> <br />\n利申i大"}]}