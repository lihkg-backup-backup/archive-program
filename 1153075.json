{"tid":1153075,"cid":26,"subCid":0,"title":"importxml 既問題","createTime":"2019-05-13T11:47:46.000Z","updateTime":"2019-05-27T11:16:53.000Z","uid":70194,"like":0,"dislike":3,"uniUserReply":3,"replies":[{"pid":"aa3f197c50e54b1e14ec3959388f9b982afc909d","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-05-13T11:47:46.000Z","msg":"話說小弟好耐以前用過importxml既功能, 係aastocks度抄D data落去個google sheet <br />\n方法係好簡單果隻, 搵個網, 跟住搵返相應既element, 例如: <br />\n=importxml(&quot;<a href=\"http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;,&quot;//table[@id='tradeLog1']//tr[2]//td[1]&quot;\" data-sr-url=\"https://r.lihkg.com/link?u=http%3A%2F%2Fwww.aastocks.com%2Ftc%2Fstocks%2Fanalysis%2Ftransaction.aspx%3Fsymbol%3D00001%22%2C%22%2F%2Ftable%5B%40id%3D%27tradeLog1%27%5D%2F%2Ftr%5B2%5D%2F%2Ftd%5B1%5D%22&d=4exhEwVElvs0p929i6aHT%2Fsf6ZhrNwlVLGl95Ukzwcs%3D&h=4357f485\" data-auto-link target=\"_blank\">http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;,&quot;//table[@id='tradeLog1']//tr[2]//td[1]&quot;</a>)<br />\n<br />\n不過而家aastocks之類既網站唔俾你直接用importxml既功能, 我見到html既code有堆奇怪註解，估係一d code唔俾你直接用importxml既指令抄野.....<br />\n<img src=\"/assets/faces/normal/cry.gif\" class=\"hkgmoji\" />"},{"pid":"f8cb37270f7075b8b36c4239a5ee559747ff068d","tid":1153075,"uid":189937,"like":1,"dislike":1,"score":0,"citedBy":1,"replyTime":"2019-05-13T12:52:36.000Z","msg":"唔係唔比你直接importxml<br />\n係本身拎到嘅HTML code parse唔到落google sheet<br />\n<img src=\"https://i.imgur.com/Xm5H52n.png\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fi.imgur.com%2FXm5H52n.png&h=116a2202&s={SIZE}\" /><br />\n由圖到睇 你拎到嘅code根本無td Tag<br />\n你依加呢個情況想拎資料最緊要知點拎而唔係諗用咩tools去拎"},{"pid":"1d7152769e895e77fb22ad062282546ecbf0885b","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"f8cb37270f7075b8b36c4239a5ee559747ff068d","tid":1153075,"uid":189937,"like":1,"dislike":1,"score":0,"citedBy":1,"replyTime":"2019-05-13T12:52:36.000Z","msg":"唔係唔比你直接importxml<br />\n係本身拎到嘅HTML code parse唔到落google sheet<br />\n<img src=\"https://i.imgur.com/Xm5H52n.png\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fi.imgur.com%2FXm5H52n.png&h=116a2202&s={SIZE}\" /><br />\n由圖到睇 你拎到嘅code根本無td Tag<br />\n你依加呢個情況想拎資料最緊要知點拎而唔係諗用咩tools去拎"},"citedBy":1,"replyTime":"2019-05-13T14:32:10.000Z","msg":"唔係好識, 巴打可唔可以講多少少. 我用最低能既inspection element 再copy xpath..... 但D教學冇咁specific 所以睇完都唔明<img src=\"/assets/faces/lomoji/26.png\" class=\"hkgmoji\" /><img src=\"/assets/faces/lomoji/26.png\" class=\"hkgmoji\" />"},{"pid":"56f885b072077e1fa47adb33038b9d6ea4363153","tid":1153075,"uid":189937,"like":1,"dislike":0,"score":1,"quote":{"pid":"1d7152769e895e77fb22ad062282546ecbf0885b","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"f8cb37270f7075b8b36c4239a5ee559747ff068d","tid":1153075,"uid":189937,"like":1,"dislike":1,"score":0,"citedBy":1,"replyTime":"2019-05-13T12:52:36.000Z","msg":"唔係唔比你直接importxml<br />\n係本身拎到嘅HTML code parse唔到落google sheet<br />\n<img src=\"https://i.imgur.com/Xm5H52n.png\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fi.imgur.com%2FXm5H52n.png&h=116a2202&s={SIZE}\" /><br />\n由圖到睇 你拎到嘅code根本無td Tag<br />\n你依加呢個情況想拎資料最緊要知點拎而唔係諗用咩tools去拎"},"citedBy":1,"replyTime":"2019-05-13T14:32:10.000Z","msg":"唔係好識, 巴打可唔可以講多少少. 我用最低能既inspection element 再copy xpath..... 但D教學冇咁specific 所以睇完都唔明<img src=\"/assets/faces/lomoji/26.png\" class=\"hkgmoji\" /><img src=\"/assets/faces/lomoji/26.png\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2019-05-13T17:07:37.000Z","msg":"其實都係要熟xpath 差唔多呢種format<br />\n<pre><code data-type=\"\">//parent[@class='whatever']/child</code></pre><br />\n搵到element但唔知喺html code嘅邊到 可以禁ctrl+shift+c去搵<br />\n我做左少少example比你<br />\n<br />\n拎menu bar item:<br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@class='menu']/div[@class='menu_item jshoverwithclass']/a/span&quot;)</code></pre><br />\n拎平均成交價 總成交量 總成交宗數 (header)<br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@class='float_l stat']/div/div[@class='float_l pad grey8 font15']&quot;)</code></pre><br />\n拎平均成交價 總成交量 總成交宗數 (value)<br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@id='AvgPrice']&quot;)</code></pre><br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@id='TotalVol']&quot;)</code></pre><br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@id='TradeCnt']&quot;)</code></pre><br />\n如果你想拎svg data即係圖表啲element importxml就完全做唔到"},{"pid":"ceb2a5c9d8c0c8e8a7502563d2d5ccc8f2a8ccee","tid":1153075,"uid":189937,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-05-13T17:12:15.000Z","msg":"tradeLog1:<br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//table[@id='tradeLog1']/thead/tr/th&quot;)</code></pre>"},{"pid":"aa5783ce674c34a3700a492786ab37aa49c8d2f7","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"ceb2a5c9d8c0c8e8a7502563d2d5ccc8f2a8ccee","tid":1153075,"uid":189937,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-05-13T17:12:15.000Z","msg":"tradeLog1:<br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//table[@id='tradeLog1']/thead/tr/th&quot;)</code></pre>"},"citedBy":0,"replyTime":"2019-05-20T09:46:07.000Z","msg":"巴打. 我終於真係識搵個path, 原來之前一路搵左錯既path <img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><br />\n感謝你既examples, 好有用<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" />"},{"pid":"e49abf15a2914e31940338989dba9198fe9f6d91","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"56f885b072077e1fa47adb33038b9d6ea4363153","tid":1153075,"uid":189937,"like":1,"dislike":0,"score":1,"quote":{"pid":"1d7152769e895e77fb22ad062282546ecbf0885b","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"f8cb37270f7075b8b36c4239a5ee559747ff068d","tid":1153075,"uid":189937,"like":1,"dislike":1,"score":0,"citedBy":1,"replyTime":"2019-05-13T12:52:36.000Z","msg":"唔係唔比你直接importxml<br />\n係本身拎到嘅HTML code parse唔到落google sheet<br />\n<img src=\"https://i.imgur.com/Xm5H52n.png\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fi.imgur.com%2FXm5H52n.png&h=116a2202&s={SIZE}\" /><br />\n由圖到睇 你拎到嘅code根本無td Tag<br />\n你依加呢個情況想拎資料最緊要知點拎而唔係諗用咩tools去拎"},"citedBy":1,"replyTime":"2019-05-13T14:32:10.000Z","msg":"唔係好識, 巴打可唔可以講多少少. 我用最低能既inspection element 再copy xpath..... 但D教學冇咁specific 所以睇完都唔明<img src=\"/assets/faces/lomoji/26.png\" class=\"hkgmoji\" /><img src=\"/assets/faces/lomoji/26.png\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2019-05-13T17:07:37.000Z","msg":"其實都係要熟xpath 差唔多呢種format<br />\n<pre><code data-type=\"\">//parent[@class='whatever']/child</code></pre><br />\n搵到element但唔知喺html code嘅邊到 可以禁ctrl+shift+c去搵<br />\n我做左少少example比你<br />\n<br />\n拎menu bar item:<br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@class='menu']/div[@class='menu_item jshoverwithclass']/a/span&quot;)</code></pre><br />\n拎平均成交價 總成交量 總成交宗數 (header)<br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@class='float_l stat']/div/div[@class='float_l pad grey8 font15']&quot;)</code></pre><br />\n拎平均成交價 總成交量 總成交宗數 (value)<br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@id='AvgPrice']&quot;)</code></pre><br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@id='TotalVol']&quot;)</code></pre><br />\n<pre><code data-type=\"\">=importxml(&quot;http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;, &quot;//div[@id='TradeCnt']&quot;)</code></pre><br />\n如果你想拎svg data即係圖表啲element importxml就完全做唔到"},"citedBy":0,"replyTime":"2019-05-20T10:10:40.000Z","msg":"係咪google sheet 問題? 巴打你果3段搵成交價/成交宗數 既importxml 係google sheet 既output result係空白 <img src=\"/assets/faces/lomoji/26.png\" class=\"hkgmoji\" /><img src=\"/assets/faces/lomoji/26.png\" class=\"hkgmoji\" />"},{"pid":"32af60b21d54ebc5ece2a23c1daa70455a112a2f","tid":1153075,"uid":189937,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-05-20T14:40:15.000Z","msg":"係google sheet問題<br />\n我自己試左都係空白"},{"pid":"efab605d72378d6d6b726ad90c19c880e02c36b1","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"32af60b21d54ebc5ece2a23c1daa70455a112a2f","tid":1153075,"uid":189937,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-05-20T14:40:15.000Z","msg":"係google sheet問題<br />\n我自己試左都係空白"},"citedBy":1,"replyTime":"2019-05-20T14:42:04.000Z","msg":"咁應該用咩software <img src=\"/assets/faces/lomoji/17.png\" class=\"hkgmoji\" />"},{"pid":"29a084cb2480df25f041e918be1b92a348c3006c","tid":1153075,"uid":189937,"like":0,"dislike":0,"score":0,"quote":{"pid":"efab605d72378d6d6b726ad90c19c880e02c36b1","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"32af60b21d54ebc5ece2a23c1daa70455a112a2f","tid":1153075,"uid":189937,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-05-20T14:40:15.000Z","msg":"係google sheet問題<br />\n我自己試左都係空白"},"citedBy":1,"replyTime":"2019-05-20T14:42:04.000Z","msg":"咁應該用咩software <img src=\"/assets/faces/lomoji/17.png\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2019-05-20T14:52:25.000Z","msg":"咩language都得<br />\nC# Python NodeJs Java都做到<br />\nkeywords: web crawler, web scraping<br />\n唔想落手寫就用呢啲<br />\n<a href=\"https://www.scraperapi.com/blog/the-10-best-web-scraping-tools\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fwww.scraperapi.com%2Fblog%2Fthe-10-best-web-scraping-tools&d=4exhEwVElvs0p929i6aHT%2Fsf6ZhrNwlVLGl95Ukzwcs%3D&h=9887502f\" data-auto-link target=\"_blank\">https://www.scraperapi.com/blog/the-10-best-web-scraping-tools</a>"},{"pid":"e85cea1739baeb5d9c99ed7b25fd4fb88e532aa4","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"29a084cb2480df25f041e918be1b92a348c3006c","tid":1153075,"uid":189937,"like":0,"dislike":0,"score":0,"quote":{"pid":"efab605d72378d6d6b726ad90c19c880e02c36b1","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"32af60b21d54ebc5ece2a23c1daa70455a112a2f","tid":1153075,"uid":189937,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-05-20T14:40:15.000Z","msg":"係google sheet問題<br />\n我自己試左都係空白"},"citedBy":1,"replyTime":"2019-05-20T14:42:04.000Z","msg":"咁應該用咩software <img src=\"/assets/faces/lomoji/17.png\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2019-05-20T14:52:25.000Z","msg":"咩language都得<br />\nC# Python NodeJs Java都做到<br />\nkeywords: web crawler, web scraping<br />\n唔想落手寫就用呢啲<br />\n<a href=\"https://www.scraperapi.com/blog/the-10-best-web-scraping-tools\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fwww.scraperapi.com%2Fblog%2Fthe-10-best-web-scraping-tools&d=4exhEwVElvs0p929i6aHT%2Fsf6ZhrNwlVLGl95Ukzwcs%3D&h=9887502f\" data-auto-link target=\"_blank\">https://www.scraperapi.com/blog/the-10-best-web-scraping-tools</a>"},"citedBy":0,"replyTime":"2019-05-20T15:35:15.000Z","msg":"<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" />"},{"pid":"dea03e027a82f6baebc06df5e1d602a8c134bb71","tid":1153075,"uid":131120,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-05-27T10:31:52.000Z","msg":"此回覆已被刪除"},{"pid":"59ff821eef46b5178b3896a8ed5d44a3479ade99","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"quote":{"pid":"dea03e027a82f6baebc06df5e1d602a8c134bb71","tid":1153075,"uid":131120,"like":0,"dislike":0,"score":0,"quote":{"pid":"aa3f197c50e54b1e14ec3959388f9b982afc909d","tid":1153075,"uid":70194,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2019-05-13T11:47:46.000Z","msg":"話說小弟好耐以前用過importxml既功能, 係aastocks度抄D data落去個google sheet <br />\n方法係好簡單果隻, 搵個網, 跟住搵返相應既element, 例如: <br />\n=importxml(&quot;<a href=\"http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;,&quot;//table[@id='tradeLog1']//tr[2]//td[1]&quot;\" data-sr-url=\"https://r.lihkg.com/link?u=http%3A%2F%2Fwww.aastocks.com%2Ftc%2Fstocks%2Fanalysis%2Ftransaction.aspx%3Fsymbol%3D00001%22%2C%22%2F%2Ftable%5B%40id%3D%27tradeLog1%27%5D%2F%2Ftr%5B2%5D%2F%2Ftd%5B1%5D%22&d=4exhEwVElvs0p929i6aHT%2Fsf6ZhrNwlVLGl95Ukzwcs%3D&h=4357f485\" data-auto-link target=\"_blank\">http://www.aastocks.com/tc/stocks/analysis/transaction.aspx?symbol=00001&quot;,&quot;//table[@id='tradeLog1']//tr[2]//td[1]&quot;</a>)<br />\n<br />\n不過而家aastocks之類既網站唔俾你直接用importxml既功能, 我見到html既code有堆奇怪註解，估係一d code唔俾你直接用importxml既指令抄野.....<br />\n<img src=\"/assets/faces/normal/cry.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2019-05-27T10:31:52.000Z","msg":"此回覆已被刪除"},"citedBy":0,"replyTime":"2019-05-27T11:16:53.000Z","msg":"係慢 仲要成日no value return. 我唔係太識 google 下先<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" />"}]}