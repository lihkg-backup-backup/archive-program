{"tid":2177325,"cid":26,"subCid":0,"title":"有無人識點樣用mongoose query sub sub document?","createTime":"2020-08-27T15:36:15.000Z","updateTime":"2020-08-28T07:39:29.000Z","uid":287326,"like":0,"dislike":1,"uniUserReply":3,"replies":[{"pid":"8a6a65daacaeb5b10b8b2db97a24ae7130103704","tid":2177325,"uid":287326,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2020-08-27T15:36:15.000Z","msg":"例如<br />\n<code>\nconst Product = mongoose.schema({\n   product_id: uuid,\n   product_quantity: number,\n})\nconst Customer = mongoose.schema({\n   customer_id: uuid,\n   customer_cart: [product],\n})\nconst Store = mongoose.schema({\n   store_id: string,\n   customers: [customer],\n})\n</code><br />\n<br />\n我有 store id customer id 同product id<br />\n我想query返對應既product<br />\n但product id同 customer id都唔係 unique<br />\n所以只可以一層亦曾咁搵入去<br />\n如何可以最efficient咁query<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" />"},{"pid":"74da6fe15dfca1071a21725924291bc77f4b805e","tid":2177325,"uid":4824,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2020-08-27T17:58:50.000Z","msg":"之前寫過<br />\n但唔記得左<img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},{"pid":"96755538c2d08763d19e8499deef8e617c03a294","tid":2177325,"uid":283951,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2020-08-27T18:26:36.000Z","msg":"睇下咁樣得唔得<br />\n<pre><code data-type=\"\">Store.findById(storeId)\n  .populate({\n    path: 'customers',\n      match: {\n        _id: customerId,\n      },\n      populate: {\n        path: 'customer_cart',\n        match: {\n          _id: productId,\n        },\n      },\n    });</code></pre>"},{"pid":"99ab4a55018a3db80ca8e0818d6699a4833b901d","tid":2177325,"uid":287326,"like":0,"dislike":0,"score":0,"quote":{"pid":"96755538c2d08763d19e8499deef8e617c03a294","tid":2177325,"uid":283951,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2020-08-27T18:26:36.000Z","msg":"睇下咁樣得唔得<br />\n<pre><code data-type=\"\">Store.findById(storeId)\n  .populate({\n    path: 'customers',\n      match: {\n        _id: customerId,\n      },\n      populate: {\n        path: 'customer_cart',\n        match: {\n          _id: productId,\n        },\n      },\n    });</code></pre>"},"citedBy":1,"replyTime":"2020-08-28T01:32:51.000Z","msg":"咁樣唔係會return佢個store咩<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><br />\n我想return個product<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" />"},{"pid":"7547475cfb4f1a4a4940402b84ba23c9fc7e22b3","tid":2177325,"uid":283951,"like":0,"dislike":0,"score":0,"quote":{"pid":"99ab4a55018a3db80ca8e0818d6699a4833b901d","tid":2177325,"uid":287326,"like":0,"dislike":0,"score":0,"quote":{"pid":"96755538c2d08763d19e8499deef8e617c03a294","tid":2177325,"uid":283951,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2020-08-27T18:26:36.000Z","msg":"睇下咁樣得唔得<br />\n<pre><code data-type=\"\">Store.findById(storeId)\n  .populate({\n    path: 'customers',\n      match: {\n        _id: customerId,\n      },\n      populate: {\n        path: 'customer_cart',\n        match: {\n          _id: productId,\n        },\n      },\n    });</code></pre>"},"citedBy":1,"replyTime":"2020-08-28T01:32:51.000Z","msg":"咁樣唔係會return佢個store咩<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /><br />\n我想return個product<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" />"},"citedBy":0,"replyTime":"2020-08-28T07:39:29.000Z","msg":"番黎嗰個store應該會包含左d products喺入面，或者你試下將個_id改做customer_id, product_id同埋改一改個findById做find({ store_id: storeId })試試"}]}