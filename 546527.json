{"tid":546527,"cid":26,"subCid":0,"title":"Computer Two條RAM係咪出咗問題?","createTime":"2018-01-31T15:14:48.000Z","updateTime":"2018-02-01T03:21:10.000Z","uid":33883,"like":3,"dislike":1,"uniUserReply":6,"replies":[{"pid":"a2a26321d6ecc943aa678b7d60977f226d3ccfad","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2018-01-31T15:14:48.000Z","msg":"<img src=\"https://image.ibb.co/mGT2tm/Struct_Demo.jpg\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fimage.ibb.co%2FmGT2tm%2FStruct_Demo.jpg&h=2d826c92&s={SIZE}\" /><br />\nComputer One個結果好正常, 但Computer Two就出咗事!<img src=\"/assets/faces/normal/cry.gif\" class=\"hkgmoji\" /> <br />\n<br />\nStructDemo.c是咁的:<br />\n<img src=\"https://image.ibb.co/no1fDm/Struct_Demo_c.jpg\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fimage.ibb.co%2Fno1fDm%2FStruct_Demo_c.jpg&h=7ada032e&s={SIZE}\" /><br />\n<br />\nP.S. 以我所知, malloc function會allocate個memory pool(i.e. heap)畀有關嘅pointer variable用. Heap就正常會喺RAM度. Computer Two個allocated heap炒咗, 係咪即係條RAM炒咗, 定其實個Harddisk都可能有問題呢? BTW, 有咩嘢Linux tools可以睇到條RAM係咪正常?! <img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" />"},{"pid":"f5bc8f951c049ba56daa0ecaf1f9d6b70d727432","tid":546527,"uid":28563,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T15:21:36.000Z","msg":"鳩估 有undefined behavior<br />\n開-Wall compile過睇睇"},{"pid":"5934fd3cd8e544e86478e1568c439e5835116182","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"f5bc8f951c049ba56daa0ecaf1f9d6b70d727432","tid":546527,"uid":28563,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T15:21:36.000Z","msg":"鳩估 有undefined behavior<br />\n開-Wall compile過睇睇"},"citedBy":1,"replyTime":"2018-01-31T15:25:42.000Z","msg":"吓? 點睇都似係runtime error喎, 不過都(一陣)試下先. Thanks!"},{"pid":"eaa476de661eba8e3e1a51e965794c01a2517c87","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"5934fd3cd8e544e86478e1568c439e5835116182","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"f5bc8f951c049ba56daa0ecaf1f9d6b70d727432","tid":546527,"uid":28563,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T15:21:36.000Z","msg":"鳩估 有undefined behavior<br />\n開-Wall compile過睇睇"},"citedBy":1,"replyTime":"2018-01-31T15:25:42.000Z","msg":"吓? 點睇都似係runtime error喎, 不過都(一陣)試下先. Thanks!"},"citedBy":0,"replyTime":"2018-01-31T15:33:56.000Z","msg":"加咗-Wall compile, 冇任何warnings出! <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},{"pid":"ab7287a91cca517803bd3885e730a76db1ba9180","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"citedBy":2,"replyTime":"2018-01-31T15:50:37.000Z","msg":"malloc size 錯左"},{"pid":"ceb764e1bb4f2e89e99b57cc759592d6453840e3","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"ab7287a91cca517803bd3885e730a76db1ba9180","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"citedBy":2,"replyTime":"2018-01-31T15:50:37.000Z","msg":"malloc size 錯左"},"citedBy":1,"replyTime":"2018-01-31T15:55:47.000Z","msg":"噉malloc size無啦啦點解會錯? <img src=\"/assets/faces/normal/oh.gif\" class=\"hkgmoji\" />"},{"pid":"0f990eb854461a8292319222f425afa8c35f223e","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2018-01-31T16:01:24.000Z","msg":"補充一下, 如果Dell[1]轉做其他index, e.g. Dell[0], Dell[2], Dell[3], Dell[4], etc.係出到正常結果的, i.e. 只有Dell[1]會出事! <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},{"pid":"5f7aeaf9f9efb459c8551b51d4284f86d21f404c","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"quote":{"pid":"ceb764e1bb4f2e89e99b57cc759592d6453840e3","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"ab7287a91cca517803bd3885e730a76db1ba9180","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"citedBy":2,"replyTime":"2018-01-31T15:50:37.000Z","msg":"malloc size 錯左"},"citedBy":1,"replyTime":"2018-01-31T15:55:47.000Z","msg":"噉malloc size無啦啦點解會錯? <img src=\"/assets/faces/normal/oh.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2018-01-31T16:06:17.000Z","msg":"<a href=\"https://stackoverflow.com/q/4523497/1847463\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fstackoverflow.com%2Fq%2F4523497%2F1847463&d=J%2BGjt9OVN8jpNQuOpJCvz2owyooGr0BEXXUM5gBrg7E%3D&h=d1839bd8\" data-auto-link target=\"_blank\">https://stackoverflow.com/q/4523497/1847463</a>"},{"pid":"e32f4f05b6666a0bfa63d1f0fc7b219a25f59dfc","tid":546527,"uid":63156,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2018-01-31T16:15:56.000Z","msg":"printf(sizeof(Brand)) 嚟睇下？"},{"pid":"3cb6e9fc85aabff7101651cc431d14adca359977","tid":546527,"uid":63156,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T16:17:30.000Z","msg":"<blockquote>printf(&quot;%d\\n&quot;, sizeof(Brand)) 嚟睇下？</blockquote>"},{"pid":"6010dc04fbd316aa2f7a28ba2af4de604b2423bf","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"5f7aeaf9f9efb459c8551b51d4284f86d21f404c","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"quote":{"pid":"ceb764e1bb4f2e89e99b57cc759592d6453840e3","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"ab7287a91cca517803bd3885e730a76db1ba9180","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"citedBy":2,"replyTime":"2018-01-31T15:50:37.000Z","msg":"malloc size 錯左"},"citedBy":1,"replyTime":"2018-01-31T15:55:47.000Z","msg":"噉malloc size無啦啦點解會錯? <img src=\"/assets/faces/normal/oh.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2018-01-31T16:06:17.000Z","msg":"<a href=\"https://stackoverflow.com/q/4523497/1847463\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fstackoverflow.com%2Fq%2F4523497%2F1847463&d=J%2BGjt9OVN8jpNQuOpJCvz2owyooGr0BEXXUM5gBrg7E%3D&h=d1839bd8\" data-auto-link target=\"_blank\">https://stackoverflow.com/q/4523497/1847463</a>"},"citedBy":0,"replyTime":"2018-01-31T16:22:08.000Z","msg":"你係咪想話struct裏面用array type, 個sizeof function會數錯size?! 噉點解Computer One又完全無問題? BTW, struct用唔到array type咪變殘廢?! 唔係掛! <img src=\"/assets/faces/normal/dead.gif\" class=\"hkgmoji\" />"},{"pid":"5a6b62e6bc239335db5766702057207150eecd71","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"3cb6e9fc85aabff7101651cc431d14adca359977","tid":546527,"uid":63156,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T16:17:30.000Z","msg":"<blockquote>printf(&quot;%d\\n&quot;, sizeof(Brand)) 嚟睇下？</blockquote>"},"citedBy":2,"replyTime":"2018-01-31T16:24:53.000Z","msg":"5400, then what?"},{"pid":"0847fb3b8cae370e743adf94a700566aa6f724e8","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"5a6b62e6bc239335db5766702057207150eecd71","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"3cb6e9fc85aabff7101651cc431d14adca359977","tid":546527,"uid":63156,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T16:17:30.000Z","msg":"<blockquote>printf(&quot;%d\\n&quot;, sizeof(Brand)) 嚟睇下？</blockquote>"},"citedBy":2,"replyTime":"2018-01-31T16:24:53.000Z","msg":"5400, then what?"},"citedBy":0,"replyTime":"2018-01-31T16:29:18.000Z","msg":"Computer One, Computer Two, 同試多一部PC, 都係5400."},{"pid":"051e117b322571dbb57c98973359ddaaffd4b73d","tid":546527,"uid":63156,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T16:33:33.000Z","msg":"print埋 &amp;(Dell[0]) 同 &amp;(Dell[1])?<br />\n我估呢度出事"},{"pid":"a65fcb9b7f8941a61877191ec5ab660b4266e4bd","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"051e117b322571dbb57c98973359ddaaffd4b73d","tid":546527,"uid":63156,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T16:33:33.000Z","msg":"print埋 &amp;(Dell[0]) 同 &amp;(Dell[1])?<br />\n我估呢度出事"},"citedBy":2,"replyTime":"2018-01-31T17:20:10.000Z","msg":"print埋 &amp;(Dell[0]), &amp;(Dell[1]), 同 &amp;(Dell[2])又點話:<br />\n<br />\n<span style=\"color: green;\">162881544, 162886944, 162892344</span><br />\nINV001, Super Power One, 10, 10000.990000<br />\nINV0    , , 744844879, 0.000000<br />\nINV003, Super Power Ten, 30, 30000.770000<br />\n<br />\n我就睇唔到出咗咩嘢事喇! <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},{"pid":"2ab4747cab78b69abae28d9a7efd16d99d9d5a92","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"a65fcb9b7f8941a61877191ec5ab660b4266e4bd","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"051e117b322571dbb57c98973359ddaaffd4b73d","tid":546527,"uid":63156,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T16:33:33.000Z","msg":"print埋 &amp;(Dell[0]) 同 &amp;(Dell[1])?<br />\n我估呢度出事"},"citedBy":2,"replyTime":"2018-01-31T17:20:10.000Z","msg":"print埋 &amp;(Dell[0]), &amp;(Dell[1]), 同 &amp;(Dell[2])又點話:<br />\n<br />\n<span style=\"color: green;\">162881544, 162886944, 162892344</span><br />\nINV001, Super Power One, 10, 10000.990000<br />\nINV0    , , 744844879, 0.000000<br />\nINV003, Super Power Ten, 30, 30000.770000<br />\n<br />\n我就睇唔到出咗咩嘢事喇! <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},"citedBy":0,"replyTime":"2018-01-31T17:22:44.000Z","msg":"i.e. 個memory pool(i.e. stack) size每個都係5400, 冇異樣喎! <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},{"pid":"0d427335b6b889a45ed4e1acd51a20fca007e7bd","tid":546527,"uid":34371,"like":0,"dislike":0,"score":0,"quote":{"pid":"ab7287a91cca517803bd3885e730a76db1ba9180","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"citedBy":2,"replyTime":"2018-01-31T15:50:37.000Z","msg":"malloc size 錯左"},"citedBy":1,"replyTime":"2018-01-31T17:24:18.000Z","msg":"應該係Brand 唔係*Brand"},{"pid":"8f43c64da1fae2f1b55ab66ee21aff0ad88830ba","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T17:27:18.000Z","msg":"睇嚟大家同我一樣, 都唔太了解C, 唯有等高手出現! <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},{"pid":"a93eb73e61e59f2875b924ff32e6acf0ff9c41a5","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"quote":{"pid":"8f43c64da1fae2f1b55ab66ee21aff0ad88830ba","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T17:27:18.000Z","msg":"睇嚟大家同我一樣, 都唔太了解C, 唯有等高手出現! <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},"citedBy":0,"replyTime":"2018-01-31T17:27:57.000Z","msg":"睇assembly + memory pool la"},{"pid":"d7793b5a8a0b50a9098e5927fe64bc7d8fdc79a6","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"quote":{"pid":"5a6b62e6bc239335db5766702057207150eecd71","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"3cb6e9fc85aabff7101651cc431d14adca359977","tid":546527,"uid":63156,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T16:17:30.000Z","msg":"<blockquote>printf(&quot;%d\\n&quot;, sizeof(Brand)) 嚟睇下？</blockquote>"},"citedBy":2,"replyTime":"2018-01-31T16:24:53.000Z","msg":"5400, then what?"},"citedBy":1,"replyTime":"2018-01-31T17:28:51.000Z","msg":"咁sizeof (*Dell )"},{"pid":"aa014f8ce7b990bd01a3f98cda2d9e02336b202a","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"0d427335b6b889a45ed4e1acd51a20fca007e7bd","tid":546527,"uid":34371,"like":0,"dislike":0,"score":0,"quote":{"pid":"ab7287a91cca517803bd3885e730a76db1ba9180","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"citedBy":2,"replyTime":"2018-01-31T15:50:37.000Z","msg":"malloc size 錯左"},"citedBy":1,"replyTime":"2018-01-31T17:24:18.000Z","msg":"應該係Brand 唔係*Brand"},"citedBy":0,"replyTime":"2018-01-31T17:38:38.000Z","msg":"錯啦, 一係sizeof(Brand), 一係sizeof(*Dell), 都係出5400!<br />\n但*Brand就出error:<br />\n <span style=\"color: red;\">error</span>: expected expression before &lsquo;Brand&rsquo;<br />\n   printf(&quot;%d\\n&quot;, sizeof(*Brand));<br />\n<br />\n<img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},{"pid":"24a16027609f1d120deb57e3d6d17089566364e5","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"d7793b5a8a0b50a9098e5927fe64bc7d8fdc79a6","tid":546527,"uid":35965,"like":0,"dislike":0,"score":0,"quote":{"pid":"5a6b62e6bc239335db5766702057207150eecd71","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"quote":{"pid":"3cb6e9fc85aabff7101651cc431d14adca359977","tid":546527,"uid":63156,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2018-01-31T16:17:30.000Z","msg":"<blockquote>printf(&quot;%d\\n&quot;, sizeof(Brand)) 嚟睇下？</blockquote>"},"citedBy":2,"replyTime":"2018-01-31T16:24:53.000Z","msg":"5400, then what?"},"citedBy":1,"replyTime":"2018-01-31T17:28:51.000Z","msg":"咁sizeof (*Dell )"},"citedBy":0,"replyTime":"2018-01-31T17:39:51.000Z","msg":"答咗啦, 咪又係出5400, 好正常喎! <img src=\"/assets/faces/normal/sosad.gif\" class=\"hkgmoji\" />"},{"pid":"59f5c07c4a52d0c69e4ff0c0d82f7f8a317b60b7","tid":546527,"uid":33883,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2018-01-31T17:43:08.000Z","msg":"唉, 都係嗰句, 等真正高手出山!<br />\n(P.S. 好撚凍, 要覺覺豬了! <img src=\"/assets/faces/normal/angel.gif\" class=\"hkgmoji\" /> )"},{"pid":"ef91ec85f909f788b89867fbdeb2d43b430c6127","tid":546527,"uid":105553,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2018-01-31T18:10:45.000Z","msg":"Dell嘅type應該係Invoice*，唔係Brand*。OSX default用clang，可以用ASAN來debug，十分方便：<br />\n<br />\nsh-3.2$ clang -g -fsanitize=address -o StructDemo StructDemo.c<br />\nsh-3.2$ ./StructDemo<br />\n=================================================================<br />\n==10001==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x62200001de18 at pc 0x000105446779 bp 0x7ffeea813960 sp 0x7ffeea813100<br />\nWRITE of size 7 at 0x62200001de18 thread T0<br />\n    #0 0x105446778 in wrap_strcpy (libclang_rt.asan_osx_dynamic.dylib:x86_64h+0x50778)<br />\n    #1 0x1053ed647 in main StructDemo.c:19<br />\n    #2 0x7fff4f853114 in start (libdyld.dylib:x86_64+0x1114)<br />\n<br />\n0x62200001de18 is located 0 bytes to the right of 5400-byte region [0x62200001c900,0x62200001de18)<br />\nallocated by thread T0 here:<br />\n    #0 0x10544c18c in wrap_malloc (libclang_rt.asan_osx_dynamic.dylib:x86_64h+0x5618c)<br />\n    #1 0x1053ed60d in main StructDemo.c:16<br />\n    #2 0x7fff4f853114 in start (libdyld.dylib:x86_64+0x1114)<br />\n<br />\nSUMMARY: AddressSanitizer: heap-buffer-overflow (libclang_rt.asan_osx_dynamic.dylib:x86_64h+0x50778) in wrap_strcpy<br />\nShadow bytes around the buggy address:<br />\n  0x1c4400003b70: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00<br />\n  0x1c4400003b80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00<br />\n  0x1c4400003b90: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00<br />\n  0x1c4400003ba0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00<br />\n  0x1c4400003bb0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00<br />\n=&gt;0x1c4400003bc0: 00 00 00[fa]fa fa fa fa fa fa fa fa fa fa fa fa<br />\n  0x1c4400003bd0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa<br />\n  0x1c4400003be0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa<br />\n  0x1c4400003bf0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa<br />\n  0x1c4400003c00: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa<br />\n  0x1c4400003c10: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa<br />\nShadow byte legend (one shadow byte represents 8 application bytes):<br />\n  Addressable:           00<br />\n  Partially addressable: 01 02 03 04 05 06 07 <br />\n  Heap left redzone:       fa<br />\n  Freed heap region:       fd<br />\n  Stack left redzone:      f1<br />\n  Stack mid redzone:       f2<br />\n  Stack right redzone:     f3<br />\n  Stack after return:      f5<br />\n  Stack use after scope:   f8<br />\n  Global redzone:          f9<br />\n  Global init order:       f6<br />\n  Poisoned by user:        f7<br />\n  Container overflow:      fc<br />\n  Array cookie:            ac<br />\n  Intra object redzone:    bb<br />\n  ASan internal:           fe<br />\n  Left alloca redzone:     ca<br />\n  Right alloca redzone:    cb<br />\n==10001==ABORTING<br />\nAbort trap: 6<br />\nsh-3.2$"},{"pid":"09df0d7c8d3e954085c95db06ce2877d389bb244","tid":546527,"uid":35965,"like":1,"dislike":0,"score":1,"citedBy":2,"replyTime":"2018-01-31T18:33:52.000Z","msg":"brand * Dell;<br />\n係(*Dell)[0].id<br />\n唔係Dell[0]-&gt;id"}]}