{"tid":2507718,"cid":26,"subCid":0,"title":"python pandas excel 問題","createTime":"2021-04-28T07:54:53.000Z","updateTime":"2021-04-29T22:38:30.000Z","uid":354403,"like":0,"dislike":0,"uniUserReply":7,"replies":[{"pid":"be56bbb7eaef735be6a7dfdc455b463a41931506","tid":2507718,"uid":354403,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2021-04-28T07:54:53.000Z","msg":"有野想向各位大佬求教<br />\n有兩個excel<br />\nB_Excel 想攞A_Excel其中既columns 同整理<br />\n但A_Excel有好多個sheet<br />\n而加我整到可以B_Excel攞同整理A_Excel第一個sheet<br />\n但我唔知應該點可以攞同整理A_Excel<br />\n所以有sheet入面其中一個既columns<br />\n入去B_Excel 同一個columns到<br />\n<img src=\"/assets/faces/big/adore.gif\" class=\"hkgmoji\" />"},{"pid":"a106994b06e82373454339b26cb91ca28390db67","tid":2507718,"uid":354403,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2021-04-28T07:55:09.000Z","msg":"<pre><code data-type=\"\">df = pd.read_excel(&quot;C:/Users/User/Desktop/t34.xls&quot;, header=None, sheet_name=None)\ndf2 = pd.read_excel(&quot;C:/Users/User/Desktop/t35.xls&quot;, header=None)\n\ndf2[1] = df[2].fillna(value =df[3])\ndf2[1] = pd.to_numeric(df2[1], errors='coerce').fillna('', downcast='infer')\n\ndf2[2] = df[12]\ndf2[2] = df2[2].str.replace(',','')\ndf2[2] = pd.to_numeric(df2[2], errors='coerce').fillna(value =df[13], downcast='infer')\n\ndf2 = df2.dropna(axis=0)\n\ndf2[1] = df2[1].astype(int)\ndf2[2] = df2[2].astype(int)\n\ndf2.to_excel(&quot;C:/Users/User/Desktop/t35.xls&quot;, index=False, header=False)</code></pre>"},{"pid":"027dd0f5e1a9ed97dab1984c129880f545761428","tid":2507718,"uid":85461,"like":0,"dislike":9,"score":-9,"citedBy":1,"replyTime":"2021-04-28T08:06:42.000Z","msg":"最撚憎pandas d function<br />\n我用pandasql<br />\n<code>\nfrom pandasql import sqldf\n\nsqldf(&quot;SELECT * FROM df2[2] INNER JOIN df2[1] WHERE df2[2].xxx = df2[1].xxx&quot;)\n</code>"},{"pid":"a6f457175b253084294f433c6e8e37a9f0ecd52f","tid":2507718,"uid":93050,"like":0,"dislike":0,"score":0,"citedBy":3,"replyTime":"2021-04-28T08:10:03.000Z","msg":"Google 幫到你<br />\n<a href=\"https://stackoverflow.com/questions/26521266/using-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F26521266%2Fusing-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook&d=APk9rvMsCVL9feuIhYiW0vFBXrQbHxe6tNmRytRnjp4%3D&h=46cc423e\" target=\"_blank\">https://stackoverflow.com/questions/26521266/using-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook</a><br />\n<br />\n我會一個sheet 一個 df, 唔知其他巴打會點做"},{"pid":"cac65c20bee8143a7f112df85b99e3fd5c17c56e","tid":2507718,"uid":51143,"like":2,"dislike":0,"score":2,"quote":{"pid":"a6f457175b253084294f433c6e8e37a9f0ecd52f","tid":2507718,"uid":93050,"like":0,"dislike":0,"score":0,"citedBy":3,"replyTime":"2021-04-28T08:10:03.000Z","msg":"Google 幫到你<br />\n<a href=\"https://stackoverflow.com/questions/26521266/using-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F26521266%2Fusing-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook&d=APk9rvMsCVL9feuIhYiW0vFBXrQbHxe6tNmRytRnjp4%3D&h=46cc423e\" target=\"_blank\">https://stackoverflow.com/questions/26521266/using-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook</a><br />\n<br />\n我會一個sheet 一個 df, 唔知其他巴打會點做"},"citedBy":0,"replyTime":"2021-04-28T08:37:34.000Z","msg":"打中文慢所以打英文。<br />\n<br />\nAbove post mentioned how to read all sheets data into DataFrames. Below is the documentation. <br />\n<a href=\"https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fpandas.pydata.org%2Fdocs%2Freference%2Fapi%2Fpandas.read_excel.html&d=APk9rvMsCVL9feuIhYiW0vFBXrQbHxe6tNmRytRnjp4%3D&h=845d10e9\" target=\"_blank\">https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html</a><br />\n<br />\nThen read below tutorial on how to combine multiple DataFrames in different ways. <br />\n<a href=\"https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fpandas.pydata.org%2Fpandas-docs%2Fstable%2Fuser_guide%2Fmerging.html&d=APk9rvMsCVL9feuIhYiW0vFBXrQbHxe6tNmRytRnjp4%3D&h=0cc5196c\" target=\"_blank\">https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html</a>"},{"pid":"10c2d6149986e0d3cb28dfd63f6d2135aa49266e","tid":2507718,"uid":107620,"like":0,"dislike":0,"score":0,"quote":{"pid":"a6f457175b253084294f433c6e8e37a9f0ecd52f","tid":2507718,"uid":93050,"like":0,"dislike":0,"score":0,"citedBy":3,"replyTime":"2021-04-28T08:10:03.000Z","msg":"Google 幫到你<br />\n<a href=\"https://stackoverflow.com/questions/26521266/using-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F26521266%2Fusing-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook&d=APk9rvMsCVL9feuIhYiW0vFBXrQbHxe6tNmRytRnjp4%3D&h=46cc423e\" target=\"_blank\">https://stackoverflow.com/questions/26521266/using-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook</a><br />\n<br />\n我會一個sheet 一個 df, 唔知其他巴打會點做"},"citedBy":0,"replyTime":"2021-04-28T08:38:30.000Z","msg":"此post已完<img src=\"/assets/faces/mouse/bye.gif\" class=\"hkgmoji\" /><br />\n<br />\n利申我都係咁做<br />\n除非唔用pandas"},{"pid":"d23c236a9164639bcb5692a8ab9a4803c900676a","tid":2507718,"uid":354403,"like":0,"dislike":0,"score":0,"quote":{"pid":"027dd0f5e1a9ed97dab1984c129880f545761428","tid":2507718,"uid":85461,"like":0,"dislike":9,"score":-9,"citedBy":1,"replyTime":"2021-04-28T08:06:42.000Z","msg":"最撚憎pandas d function<br />\n我用pandasql<br />\n<code>\nfrom pandasql import sqldf\n\nsqldf(&quot;SELECT * FROM df2[2] INNER JOIN df2[1] WHERE df2[2].xxx = df2[1].xxx&quot;)\n</code>"},"citedBy":2,"replyTime":"2021-04-29T06:15:38.000Z","msg":"想問下pandas 同pandasql既分別係咩?<img src=\"/assets/faces/big/adore.gif\" class=\"hkgmoji\" />"},{"pid":"7cafc587284b5b30fb5f147e6ee374d1e5213699","tid":2507718,"uid":354403,"like":0,"dislike":0,"score":0,"quote":{"pid":"a6f457175b253084294f433c6e8e37a9f0ecd52f","tid":2507718,"uid":93050,"like":0,"dislike":0,"score":0,"citedBy":3,"replyTime":"2021-04-28T08:10:03.000Z","msg":"Google 幫到你<br />\n<a href=\"https://stackoverflow.com/questions/26521266/using-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F26521266%2Fusing-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook&d=APk9rvMsCVL9feuIhYiW0vFBXrQbHxe6tNmRytRnjp4%3D&h=46cc423e\" target=\"_blank\">https://stackoverflow.com/questions/26521266/using-pandas-to-pd-read-excel-for-multiple-worksheets-of-the-same-workbook</a><br />\n<br />\n我會一個sheet 一個 df, 唔知其他巴打會點做"},"citedBy":0,"replyTime":"2021-04-29T06:16:55.000Z","msg":"用左其他方法<br />\n用左個loop去每一個sheet去做<br />\n麻煩哂<img src=\"/assets/faces/big/adore.gif\" class=\"hkgmoji\" />"},{"pid":"bf6262fab473a25dcfb5a24b775c25da954abdab","tid":2507718,"uid":85461,"like":0,"dislike":0,"score":0,"quote":{"pid":"d23c236a9164639bcb5692a8ab9a4803c900676a","tid":2507718,"uid":354403,"like":0,"dislike":0,"score":0,"quote":{"pid":"027dd0f5e1a9ed97dab1984c129880f545761428","tid":2507718,"uid":85461,"like":0,"dislike":9,"score":-9,"citedBy":1,"replyTime":"2021-04-28T08:06:42.000Z","msg":"最撚憎pandas d function<br />\n我用pandasql<br />\n<code>\nfrom pandasql import sqldf\n\nsqldf(&quot;SELECT * FROM df2[2] INNER JOIN df2[1] WHERE df2[2].xxx = df2[1].xxx&quot;)\n</code>"},"citedBy":2,"replyTime":"2021-04-29T06:15:38.000Z","msg":"想問下pandas 同pandasql既分別係咩?<img src=\"/assets/faces/big/adore.gif\" class=\"hkgmoji\" />"},"citedBy":0,"replyTime":"2021-04-29T07:05:44.000Z","msg":"pandasql 可以寫sql code <br />\npandas 唔得 佢syntax 好複雜"},{"pid":"cc5058455dee123fcaff81e578f38366bd7fcddf","tid":2507718,"uid":51225,"like":2,"dislike":0,"score":2,"quote":{"pid":"d23c236a9164639bcb5692a8ab9a4803c900676a","tid":2507718,"uid":354403,"like":0,"dislike":0,"score":0,"quote":{"pid":"027dd0f5e1a9ed97dab1984c129880f545761428","tid":2507718,"uid":85461,"like":0,"dislike":9,"score":-9,"citedBy":1,"replyTime":"2021-04-28T08:06:42.000Z","msg":"最撚憎pandas d function<br />\n我用pandasql<br />\n<code>\nfrom pandasql import sqldf\n\nsqldf(&quot;SELECT * FROM df2[2] INNER JOIN df2[1] WHERE df2[2].xxx = df2[1].xxx&quot;)\n</code>"},"citedBy":2,"replyTime":"2021-04-29T06:15:38.000Z","msg":"想問下pandas 同pandasql既分別係咩?<img src=\"/assets/faces/big/adore.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2021-04-29T07:38:18.000Z","msg":"比識sql但唔識pandas又死要用嘅人<img src=\"/assets/faces/normal/hoho.gif\" class=\"hkgmoji\" />"},{"pid":"ecef3518126aa85cf46f182ee4c4dbe7af62b66d","tid":2507718,"uid":59586,"like":0,"dislike":0,"score":0,"quote":{"pid":"cc5058455dee123fcaff81e578f38366bd7fcddf","tid":2507718,"uid":51225,"like":2,"dislike":0,"score":2,"quote":{"pid":"d23c236a9164639bcb5692a8ab9a4803c900676a","tid":2507718,"uid":354403,"like":0,"dislike":0,"score":0,"quote":{"pid":"027dd0f5e1a9ed97dab1984c129880f545761428","tid":2507718,"uid":85461,"like":0,"dislike":9,"score":-9,"citedBy":1,"replyTime":"2021-04-28T08:06:42.000Z","msg":"最撚憎pandas d function<br />\n我用pandasql<br />\n<code>\nfrom pandasql import sqldf\n\nsqldf(&quot;SELECT * FROM df2[2] INNER JOIN df2[1] WHERE df2[2].xxx = df2[1].xxx&quot;)\n</code>"},"citedBy":2,"replyTime":"2021-04-29T06:15:38.000Z","msg":"想問下pandas 同pandasql既分別係咩?<img src=\"/assets/faces/big/adore.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2021-04-29T07:38:18.000Z","msg":"比識sql但唔識pandas又死要用嘅人<img src=\"/assets/faces/normal/hoho.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2021-04-29T07:40:53.000Z","msg":"<img src=\"/assets/faces/cow/sosad.gif\" class=\"hkgmoji\" /> pandas sql有咩優勢 未用過唔知"},{"pid":"a360cb0c7f6efddc58716bef3bf1f8c21d60f95d","tid":2507718,"uid":51225,"like":0,"dislike":1,"score":-1,"quote":{"pid":"ecef3518126aa85cf46f182ee4c4dbe7af62b66d","tid":2507718,"uid":59586,"like":0,"dislike":0,"score":0,"quote":{"pid":"cc5058455dee123fcaff81e578f38366bd7fcddf","tid":2507718,"uid":51225,"like":2,"dislike":0,"score":2,"quote":{"pid":"d23c236a9164639bcb5692a8ab9a4803c900676a","tid":2507718,"uid":354403,"like":0,"dislike":0,"score":0,"citedBy":2,"replyTime":"2021-04-29T06:15:38.000Z","msg":"想問下pandas 同pandasql既分別係咩?<img src=\"/assets/faces/big/adore.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2021-04-29T07:38:18.000Z","msg":"比識sql但唔識pandas又死要用嘅人<img src=\"/assets/faces/normal/hoho.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2021-04-29T07:40:53.000Z","msg":"<img src=\"/assets/faces/cow/sosad.gif\" class=\"hkgmoji\" /> pandas sql有咩優勢 未用過唔知"},"citedBy":1,"replyTime":"2021-04-29T07:58:53.000Z","msg":"Pandas documentation本身已有compare過兩者嘅syntax<br />\n<br />\n<a href=\"https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_sql.html\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fpandas.pydata.org%2Fdocs%2Fgetting_started%2Fcomparison%2Fcomparison_with_sql.html&d=APk9rvMsCVL9feuIhYiW0vFBXrQbHxe6tNmRytRnjp4%3D&h=5fff90dd\" target=\"_blank\">https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_sql.html</a><br />\n<br />\n個人而言冇感受過有咩情況下一定要用sql。再者，普通情況下可用df.query()嚟執下類似sql嘅condition，但無乜大分別<br />\n<br />\n其實關鍵都係肯唔肯花時間學，咩最憎pandas syntax果啲借口真係多尻餘，如果你只想借用pandas但冇心學咁咪用sql囉<img src=\"/assets/faces/normal/bouncy.gif\" class=\"hkgmoji\" />"},{"pid":"fc78088984df45d6530135fb49c1dbf3df51d223","tid":2507718,"uid":107620,"like":0,"dislike":0,"score":0,"quote":{"pid":"a360cb0c7f6efddc58716bef3bf1f8c21d60f95d","tid":2507718,"uid":51225,"like":0,"dislike":1,"score":-1,"quote":{"pid":"ecef3518126aa85cf46f182ee4c4dbe7af62b66d","tid":2507718,"uid":59586,"like":0,"dislike":0,"score":0,"quote":{"pid":"cc5058455dee123fcaff81e578f38366bd7fcddf","tid":2507718,"uid":51225,"like":2,"dislike":0,"score":2,"citedBy":1,"replyTime":"2021-04-29T07:38:18.000Z","msg":"比識sql但唔識pandas又死要用嘅人<img src=\"/assets/faces/normal/hoho.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2021-04-29T07:40:53.000Z","msg":"<img src=\"/assets/faces/cow/sosad.gif\" class=\"hkgmoji\" /> pandas sql有咩優勢 未用過唔知"},"citedBy":1,"replyTime":"2021-04-29T07:58:53.000Z","msg":"Pandas documentation本身已有compare過兩者嘅syntax<br />\n<br />\n<a href=\"https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_sql.html\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fpandas.pydata.org%2Fdocs%2Fgetting_started%2Fcomparison%2Fcomparison_with_sql.html&d=APk9rvMsCVL9feuIhYiW0vFBXrQbHxe6tNmRytRnjp4%3D&h=5fff90dd\" target=\"_blank\">https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_sql.html</a><br />\n<br />\n個人而言冇感受過有咩情況下一定要用sql。再者，普通情況下可用df.query()嚟執下類似sql嘅condition，但無乜大分別<br />\n<br />\n其實關鍵都係肯唔肯花時間學，咩最憎pandas syntax果啲借口真係多尻餘，如果你只想借用pandas但冇心學咁咪用sql囉<img src=\"/assets/faces/normal/bouncy.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2021-04-29T08:28:56.000Z","msg":"認同，唔用python咪得<br />\n再唔係用numpy囉<img src=\"/assets/faces/dog/smile.gif\" class=\"hkgmoji\" /><br />\n<br />\npandas syntax都憎<br />\n咁有咩唔憎<img src=\"/assets/faces/dog/hehe.gif\" class=\"hkgmoji\" />"},{"pid":"0a37abe9afe2e11ace2c25b081d4992c52dc9ac2","tid":2507718,"uid":85461,"like":0,"dislike":0,"score":0,"quote":{"pid":"fc78088984df45d6530135fb49c1dbf3df51d223","tid":2507718,"uid":107620,"like":0,"dislike":0,"score":0,"quote":{"pid":"a360cb0c7f6efddc58716bef3bf1f8c21d60f95d","tid":2507718,"uid":51225,"like":0,"dislike":1,"score":-1,"quote":{"pid":"ecef3518126aa85cf46f182ee4c4dbe7af62b66d","tid":2507718,"uid":59586,"like":0,"dislike":0,"score":0,"citedBy":1,"replyTime":"2021-04-29T07:40:53.000Z","msg":"<img src=\"/assets/faces/cow/sosad.gif\" class=\"hkgmoji\" /> pandas sql有咩優勢 未用過唔知"},"citedBy":1,"replyTime":"2021-04-29T07:58:53.000Z","msg":"Pandas documentation本身已有compare過兩者嘅syntax<br />\n<br />\n<a href=\"https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_sql.html\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fpandas.pydata.org%2Fdocs%2Fgetting_started%2Fcomparison%2Fcomparison_with_sql.html&d=APk9rvMsCVL9feuIhYiW0vFBXrQbHxe6tNmRytRnjp4%3D&h=5fff90dd\" target=\"_blank\">https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_sql.html</a><br />\n<br />\n個人而言冇感受過有咩情況下一定要用sql。再者，普通情況下可用df.query()嚟執下類似sql嘅condition，但無乜大分別<br />\n<br />\n其實關鍵都係肯唔肯花時間學，咩最憎pandas syntax果啲借口真係多尻餘，如果你只想借用pandas但冇心學咁咪用sql囉<img src=\"/assets/faces/normal/bouncy.gif\" class=\"hkgmoji\" />"},"citedBy":1,"replyTime":"2021-04-29T08:28:56.000Z","msg":"認同，唔用python咪得<br />\n再唔係用numpy囉<img src=\"/assets/faces/dog/smile.gif\" class=\"hkgmoji\" /><br />\n<br />\npandas syntax都憎<br />\n咁有咩唔憎<img src=\"/assets/faces/dog/hehe.gif\" class=\"hkgmoji\" />"},"citedBy":0,"replyTime":"2021-04-29T22:38:30.000Z","msg":"Pandas 連一個pivot table 都可以煩撚到咁<br />\n學好左sql 學pandas做咩春<br />\n就算 Interview 都係問你SQL<br />\n<br />\n<pre><code data-type=\"\">SELECT day, AVG(tip), COUNT(*)\nFROM tips\nGROUP BY day;</code></pre><br />\n<br />\n<pre><code data-type=\"\">tips.groupby(&quot;day&quot;).agg({&quot;tip&quot;: np.mean, &quot;day&quot;: np.size})</code></pre>"}]}