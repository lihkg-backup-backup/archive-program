{"tid":872477,"cid":18,"subCid":0,"title":"Excel 高手請入! (長文)","createTime":"2018-10-22T17:16:04.000Z","updateTime":"2018-10-22T17:51:26.000Z","uid":16113,"like":1,"dislike":1,"uniUserReply":3,"replies":[{"pid":"c72f137b26851a6a6818a484d9cd92b74deb9f7f","tid":872477,"uid":16113,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2018-10-22T17:16:04.000Z","msg":"小弟最近幫公司整 reporting template, 想請教下 INDIRECT function 有冇方法link去closed workbook? (or 有冇方法做到以下效果?) 其實 google 過但係都解決唔到, 所以想上嚟問吓大家<img src=\"/assets/faces/normal/adore.gif\" class=\"hkgmoji\" /> <br />\n<br />\n為咗易啲明我整咗個簡單實例: <br />\nTotal 3 個 Workbook, 分別係 Workbook A, Workbook B 同 Workbook C<br />\nWorkbook A: Formula driven, refer to Workbook B/C data<br />\nWorkbook B: Value only data, 以下代表 Week 1 data<br />\nWorkbook C: Value only data, 以下代表 Week 2 data<br />\n<br />\nWorkbook A:<br />\n<img src=\"https://na.cx/i/Lkr9S7X.jpg\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fna.cx%2Fi%2FLkr9S7X.jpg&h=d22ea528&s={SIZE}\" /><br />\n- Workbook A作用係想show返drop down list (B2) 所揀嘅Week相應嘅數字, 即係揀唔同Week, suppose formula入邊嘅file path都要相應跟住轉, that's why 要用INDIRECT<br />\n- A1 = 用Formula去show會因應B2 drop down list而轉嘅file path, for之後C2用INDIRECT apply<br />\n- B2 = Drop down list, 有Week 1 - Week 52揀<br />\n- C2 = INDIRECT去show A2 show出嚟堆formula嘅result<br />\n<br />\nWorkbook B:<br />\n<img src=\"https://na.cx/i/aM80ZSR.jpg\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fna.cx%2Fi%2FaM80ZSR.jpg&h=7668bf3d&s={SIZE}\" /><br />\n- Source data<br />\n<br />\nWorkbook C:<br />\n<img src=\"https://na.cx/i/c6hMVrf.jpg\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fna.cx%2Fi%2Fc6hMVrf.jpg&h=4dc7d6a6&s={SIZE}\" /><br />\n- Source data<br />\n<br />\nBi-weekly update嘅source data會有人每星期upload上drive, 所以個file path係有得set定, 而我個task就係每星期要開1次Workbook A 揀current week睇result, 再save做一份text only嘅weekly report<br />\n<br />\n理想：<br />\n<img src=\"https://na.cx/i/whtsE1g.jpg\" data-thumbnail-src=\"https://i.lih.kg/thumbnail?u=https%3A%2F%2Fna.cx%2Fi%2FwhtsE1g.jpg&h=55979bc0&s={SIZE}\" /><br />\n- 揀Week 1就出1000, Week 2就2000, 但最重要嘅係even關咗Workbook B/C都會show到<br />\n<br />\n問題：<br />\n- INDIRECT 只適用於opened workbook..一關咗就會出#REF.. 而且現實每Week我有超過20個Workbook A.. 所以無可能開哂全部workbook先睇result.. 所以想知有冇其他方法做到上邊一揀drop down list就自動return果個week嘅result嘅效果?<br />\n<br />\nAlternatives：<br />\n1. 用INDEX -&gt; 因為條path有variables (Week 1 to Week 2) 所以要用INDIRECT<br />\n2. 用VBA -&gt; 因為條path有variables, 小弟唔識寫... 如果固定path就寫到<br />\n3. 每次Find &amp; Replace all formula cells (i.e. Replace all &quot;Week 1&quot; with &quot;Week 2&quot; 如於類推)<br />\n-&gt; 原理上係work, 因為replace嘅範圍涉及cross file, 每次replace一行 excel都會pop up個update value alert出嚟, 咁禁法搞唔掂<br />\n4. 間硬fix死條path同file name, 即係每星期我manual rename堆data同放去固定path, 再save as 一份果個week嘅report -&gt; 原理上都OK, 但好唔方便<br />\n<br />\n困擾咗好耐 <img src=\"/assets/faces/normal/frown.gif\" class=\"hkgmoji\" /> 我知道好長同可能1999 所以講聲唔好意思先, 同埋無論識唔識都唔該大家先<img src=\"/assets/faces/normal/hoho.gif\" class=\"hkgmoji\" />"},{"pid":"c0572dd1f22498f49eac928fb6ce91dcabcc481f","tid":872477,"uid":211528,"like":0,"dislike":0,"score":0,"citedBy":0,"replyTime":"2018-10-22T17:16:43.000Z","msg":"此回覆已被刪除"},{"pid":"8fdaaf6dce75c76659619bfcc957dcac16578d08","tid":872477,"uid":177572,"like":1,"dislike":0,"score":1,"citedBy":0,"replyTime":"2018-10-22T17:51:26.000Z","msg":"VBA link有variable:<br />\n<a href=\"https://stackoverflow.com/questions/50375590/how-to-write-a-vba-with-a-variable-within-the-path\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F50375590%2Fhow-to-write-a-vba-with-a-variable-within-the-path&d=nVIhS4%2BOkUQoKi76uSyciMP%2FddU7lKBqZb2OVh9Tir8%3D&h=524cfdf3\" target=\"_blank\">https://stackoverflow.com/questions/50375590/how-to-write-a-vba-with-a-variable-within-the-path</a><br />\n<br />\n唔開data only file搬data:<br />\n<a href=\"https://stackoverflow.com/questions/43940407/vba-excel-match-and-retrive-values-from-another-workbook\" data-sr-url=\"https://r.lihkg.com/link?u=https%3A%2F%2Fstackoverflow.com%2Fquestions%2F43940407%2Fvba-excel-match-and-retrive-values-from-another-workbook&d=nVIhS4%2BOkUQoKi76uSyciMP%2FddU7lKBqZb2OVh9Tir8%3D&h=099f5f71\" target=\"_blank\">https://stackoverflow.com/questions/43940407/vba-excel-match-and-retrive-values-from-another-workbook</a><br />\n<br />\n我一google就搵到<img src=\"/assets/faces/normal/clown.gif\" class=\"hkgmoji\" /> 樓主係咪真係google過<img src=\"/assets/faces/normal/clown.gif\" class=\"hkgmoji\" />"}]}